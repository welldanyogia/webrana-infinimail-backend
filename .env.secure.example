# =============================================================================
# WEBRANA INFINIMAIL - SECURE CONFIGURATION TEMPLATE
# =============================================================================
# SECURITY NOTICE:
# - NEVER commit .env files to version control
# - Generate all secrets using cryptographically secure random generators
# - Use different values for development, staging, and production
# =============================================================================

# -----------------------------------------------------------------------------
# ENVIRONMENT
# -----------------------------------------------------------------------------
APP_ENV=production
# Values: development, staging, production

# -----------------------------------------------------------------------------
# DATABASE CONFIGURATION
# -----------------------------------------------------------------------------
# Generate password: openssl rand -base64 32
# IMPORTANT: Use sslmode=verify-full in production
DATABASE_URL=postgres://infinimail:CHANGE_THIS_STRONG_PASSWORD@localhost:5432/infinimail?sslmode=verify-full

# Connection pool settings (optional, defaults are usually fine)
# DB_MAX_OPEN_CONNS=25
# DB_MAX_IDLE_CONNS=5
# DB_CONN_MAX_LIFETIME=5m

# -----------------------------------------------------------------------------
# API SERVER CONFIGURATION
# -----------------------------------------------------------------------------
API_PORT=8080

# Generate API key: openssl rand -hex 32
# Minimum 32 characters required - REQUIRED in production
API_KEY=your_64_character_hex_api_key_generated_with_openssl_rand_hex_32

# Allowed origins for CORS (comma-separated)
# NEVER use * in production - REQUIRED in production
ALLOWED_ORIGINS=https://yourdomain.com,https://app.yourdomain.com

# -----------------------------------------------------------------------------
# RATE LIMITING
# -----------------------------------------------------------------------------
RATE_LIMIT_REQUESTS=100
# Requests per second per IP
RATE_LIMIT_BURST=20
# Burst size for rate limiter

# -----------------------------------------------------------------------------
# SMTP SERVER CONFIGURATION
# -----------------------------------------------------------------------------
SMTP_PORT=25
SMTP_DOMAIN=mail.yourdomain.com
SMTP_ADDR=:25

# SMTP Security Settings
SMTP_ALLOW_INSECURE=false
# NEVER set to true in production
SMTP_MAX_MESSAGE_SIZE=26214400
# 25 MB in bytes
SMTP_MAX_RECIPIENTS=100
SMTP_READ_TIMEOUT=60s
SMTP_WRITE_TIMEOUT=60s

# TLS Configuration (recommended for production)
# SMTP_TLS_CERT=/etc/ssl/certs/smtp.crt
# SMTP_TLS_KEY=/etc/ssl/private/smtp.key

# -----------------------------------------------------------------------------
# FILE STORAGE CONFIGURATION
# -----------------------------------------------------------------------------
ATTACHMENT_STORAGE_PATH=/var/lib/infinimail/attachments

# Maximum attachment size (bytes)
MAX_ATTACHMENT_SIZE=26214400

# -----------------------------------------------------------------------------
# FEATURES
# -----------------------------------------------------------------------------
# Auto-provisioning (creates mailboxes automatically when receiving mail)
AUTO_PROVISIONING_ENABLED=true

# -----------------------------------------------------------------------------
# LOGGING CONFIGURATION
# -----------------------------------------------------------------------------
LOG_LEVEL=info
# Values: debug, info, warn, error

# -----------------------------------------------------------------------------
# SECURITY CHECKLIST FOR PRODUCTION
# -----------------------------------------------------------------------------
# [ ] API_KEY is set (minimum 32 characters)
# [ ] ALLOWED_ORIGINS does not contain wildcard (*)
# [ ] DATABASE_URL uses sslmode=verify-full or sslmode=require
# [ ] SMTP_ALLOW_INSECURE=false
# [ ] APP_ENV=production
# [ ] All secrets are unique and randomly generated
# [ ] .env file is NOT committed to version control
# [ ] File permissions are restricted (chmod 600 .env)
# [ ] ACME_STAGING=false for production certificates
# [ ] ACME_EMAIL is set for certificate expiry notifications
# [ ] CERT_STORAGE_PATH has restricted permissions (chmod 700)

# -----------------------------------------------------------------------------
# Domain Manager / DNS Guide Configuration
# -----------------------------------------------------------------------------
# SMTP hostname shown in DNS setup guide (MX record target)
# This should be your actual mail server hostname
SMTP_HOSTNAME=mail.yourdomain.com

# Server IP shown in DNS setup guide (A record value)
# This should be your actual server's public IP address
SERVER_IP=YOUR_SERVER_PUBLIC_IP

# -----------------------------------------------------------------------------
# ACME / Certificate Configuration (Let's Encrypt)
# -----------------------------------------------------------------------------
# ACME directory URL
# Staging: https://acme-staging-v02.api.letsencrypt.org/directory (for testing)
# Production: https://acme-v02.api.letsencrypt.org/directory (for real certificates)
ACME_DIRECTORY_URL=https://acme-v02.api.letsencrypt.org/directory

# Email for ACME account (REQUIRED - receives certificate expiry notifications)
ACME_EMAIL=admin@yourdomain.com

# Use staging server (MUST be false for production)
ACME_STAGING=false

# Path to store SSL certificates (ensure restricted permissions: chmod 700)
CERT_STORAGE_PATH=/etc/infinimail/certs

# Days before expiry to trigger auto-renewal (default: 30)
CERT_RENEWAL_DAYS=30

# Interval for checking certificate expiry (default: 24h)
# Format: Go duration string (e.g., 24h, 12h, 1h)
CERT_RENEWAL_CHECK_INTERVAL=24h
